<div class="services-container">
  <div class="services-header">
    <div class="header-spacer"></div>
    <h3 class="services-title">Services Proposés</h3>
    <button 
      mat-raised-button 
      color="primary" 
      (click)="addNewService()"
      class="add-service-btn primary-action-btn header-action"
      [disabled]="isAddingNew || editingService">
      <mat-icon>add</mat-icon>
      Ajouter un service
    </button>
  </div>

  <!-- Formulaire d'ajout/édition de service -->
  <div *ngIf="isAddingNew || editingService" class="service-form-container">
    <div class="service-form-card">
      <div class="form-header">
        <h3 class="form-title">
          {{ isAddingNew ? 'Ajouter un nouveau service' : 'Modifier le service' }}
        </h3>
      </div>
      
      <div class="form-content">
        <form [formGroup]="serviceForm" class="service-form">
          <div class="form-row">
            <div class="form-field">
              <label class="field-label">Titre du service*</label>
              <input 
                type="text" 
                formControlName="title" 
                placeholder="Ex: Location de vélo"
                class="form-input"
                [class.invalid]="isFieldInvalid('title')">
              <div *ngIf="isFieldInvalid('title')" class="error-message">
                {{ getErrorMessage('title') }}
              </div>
            </div>

            <div class="form-field">
              <label class="field-label">Catégorie*</label>
              <select formControlName="category" class="form-select" [class.invalid]="isFieldInvalid('category')">
                <option value="">Sélectionnez une catégorie</option>
                <option *ngFor="let category of categories" [value]="category">
                  {{ category }}
                </option>
              </select>
              <div *ngIf="isFieldInvalid('category')" class="error-message">
                {{ getErrorMessage('category') }}
              </div>
            </div>
          </div>

          <div class="form-field full-width">
            <label class="field-label">Description*</label>
            <textarea 
              formControlName="description" 
              rows="3" 
              placeholder="Décrivez votre service en détail..."
              class="form-textarea"
              [class.invalid]="isFieldInvalid('description')"></textarea>
            <div *ngIf="isFieldInvalid('description')" class="error-message">
              {{ getErrorMessage('description') }}
            </div>
          </div>

          <div class="form-row">
            <div class="form-field">
              <label class="field-label">Prix (€)*</label>
              <input 
                type="number" 
                formControlName="price" 
                min="0" 
                step="0.01"
                class="form-input"
                [class.invalid]="isFieldInvalid('price')">
              <div *ngIf="isFieldInvalid('price')" class="error-message">
                {{ getErrorMessage('price') }}
              </div>
            </div>
          </div>
        </form>
      </div>

      <div class="form-actions">
        <button (click)="cancelEdit()" class="cancel-btn">
          <mat-icon>cancel</mat-icon>
          Annuler
        </button>
        <button 
          (click)="saveService()" 
          [disabled]="serviceForm.invalid" 
          class="save-btn">
          <mat-icon>save</mat-icon>
          {{ isAddingNew ? 'Ajouter' : 'Sauvegarder' }}
        </button>
      </div>
    </div>
  </div>

  <!-- Liste des services existants -->
  <div class="services-list">
    <mat-card *ngFor="let service of services" class="service-card" appearance="outlined">
      <div class="service-header">
        <div class="service-actions">
          <button mat-icon-button color="primary" (click)="editService(service)" 
                  [disabled]="isAddingNew || editingService">
            <mat-icon>edit</mat-icon>
          </button>
          <button mat-icon-button color="warn" (click)="deleteService(service.id)"
                  [disabled]="isAddingNew || editingService">
            <mat-icon>delete</mat-icon>
          </button>
        </div>
      </div>
      <div class="service-content">
        <h4 class="service-title">{{ service.title }}</h4>
        <p class="service-category">{{ service.category }}</p>
        <p class="service-description">{{ service.description }}</p>
        <p class="service-price">{{ service.price }} €</p>
      </div>
    </mat-card>
  </div>

  <!-- Message si aucun service -->
  <div *ngIf="services.length === 0 && !isAddingNew" class="no-services">
    <div class="empty-state-card">
      <div class="empty-state-content">
        <mat-icon class="empty-icon">add_business</mat-icon>
        <h4>Aucun service proposé</h4>
        <p>Commencez par ajouter vos premiers services pour les faire découvrir aux autres utilisateurs.</p>
      </div>
    </div>
  </div>
</div>
