<!-- État de chargement -->
<div *ngIf="isLoading" class="loading-container">
  <div class="loading-spinner">
    <mat-icon class="spinner-icon">refresh</mat-icon>
    <p>Chargement des informations du profil...</p>
  </div>
</div>

<!-- État d'erreur -->
<div *ngIf="hasError && !isLoading" class="error-container">
  <div class="error-message">
    <mat-icon class="error-icon">error</mat-icon>
    <h3>Erreur de chargement</h3>
    <p>Impossible de récupérer les informations de votre profil.</p>
    <button mat-raised-button color="primary" (click)="retryLoadData()">
      <mat-icon>refresh</mat-icon>
      Réessayer
    </button>
  </div>
</div>

<!-- Contenu principal -->
<div *ngIf="!isLoading && !hasError">
  <ng-container *ngIf="!isEditMode; else editMode">
    <app-display-profile [user]="displayedUser" [services]="services" [userRole]="loggedUser.role" />
  </ng-container>
  <ng-template #editMode>
    <app-update-profile [user]="displayedUser" [services]="services" [userRole]="loggedUser.role" (profileDataChange)="onProfileDataChange($event)" />
  </ng-template>

  <div class="profile-action-btn-container" *ngIf="isCurrentUserProfile()">
    <button mat-raised-button class="profile-action-btn" (click)="toggleEditMode()">
      <mat-icon class="icon-left">{{ isEditMode ? 'done' : 'edit' }}</mat-icon>
      {{ getButtonText() }}
    </button>
  </div>
</div>